#!/usr/bin/env node
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var path=require("path"),getFolderContent=_interopDefault(require("vamtiger-get-directory-content")),createFile=_interopDefault(require("vamtiger-create-file"));function __awaiter(e,t,a,n){return new(a||(a=Promise))(function(r,c){function i(e){try{u(n.next(e))}catch(e){c(e)}}function o(e){try{u(n.throw(e))}catch(e){c(e)}}function u(e){e.done?r(e.value):new a(function(t){t(e.value)}).then(i,o)}u((n=n.apply(e,t)).next())})}var stringify=JSON.stringify,cwd=process.cwd,format=require("beautify"),config={format:"json"},packagePath=path.resolve(cwd(),"package"),packageJson=getPackageJson(),_a=packageJson||{},_b=_a.name,name=void 0===_b?"":_b,_c=_a.scripts,scripts=void 0===_c?{"bundle-source-main":""}:_c,mainBundleScript=scripts["bundle-source-main"],fileName=new RegExp(name);function getPackageJson(){try{return require(packagePath)}catch(e){console.warn("Failed to load packge.json: "+packagePath)}}function generateBundleScript(){return __awaiter(this,void 0,void 0,function(){var e,t,a,n;return __generator(this,function(r){switch(r.label){case 0:return[4,getFolderContent(cwd())];case 1:return e=r.sent(),t=e.filter(function(e){return e.match(fileName)}),a=t.map(function(e){return"vamtiger-bundle-typescript --relativePath --entryFilePath source/"+e+" --bundleFilePath build/"+e+".js --format iife --sourcemap true --copySourceMap --minify"}).join(" && "),n=mainBundleScript+" && "+a,packageJson&&n?(packageJson.scripts["bundle-source"]=n,[4,createFile(packagePath+".json",format(stringify(packageJson),config))]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})}name?scripts?mainBundleScript?generateBundleScript():console.warn("Failed to reference package.scripts['bundle-source-main']"):console.warn("Failed to reference package scripts"):console.warn("Failed to reference package name");
//# sourceMappingURL=vamtiger-generate-bundle-script.js.map
